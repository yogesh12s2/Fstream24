<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>ChadStreamz Player</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- MediaElement.js CSS -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mediaelement@7.0.5/build/mediaelementplayer.min.css">

<!-- FontAwesome for custom icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">

<style>
body { margin: 0; background: #000; color: #fff; font-family: Arial, sans-serif; }
.player-container { position: relative; width: 100%; background: black; }

#stream-media {
  width: 100%;
  max-height: 70vh; /* Only limit in normal mode */
  background: black;
}

.player-container.fullscreen #stream-media {
  max-height: 100vh !important; /* Fullscreen override */
}

.watermark {
  position: absolute;
  top: 12px;
  right: 12px;
  width: 80px;
  opacity: 0.7;
  pointer-events: none;
  z-index: 10;
}

/* Bottom Section & Suggestions Grid */
.bottom-section { padding: 20px; }
.download-btn { display: inline-block; padding: 12px 20px; background: #ff0000; color: #fff; text-decoration: none; font-size: 16px; font-weight: bold; border-radius: 6px; transition: 0.3s; }
.download-btn:hover { background: #cc0000; }
.suggestions { margin-top: 30px; }
.suggestions h2 { font-size: 22px; margin-bottom: 20px; }
.movies-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(160px, 1fr)); gap: 18px; }
.movie-card { cursor: pointer; transition: transform 0.3s; }
.movie-card:hover { transform: scale(1.05); }
.movie-card img { width: 100%; border-radius: 8px; display: block; box-shadow: 0 4px 8px rgba(0,0,0,0.5); }
.movie-title { margin-top: 8px; font-size: 14px; text-align: center; color: #ccc; }

@media(max-width:768px){
  .movie-title { font-size: 12px; }
  .download-btn { font-size: 14px; padding: 10px 16px; }
}

/* Custom FontAwesome for MediaElement buttons */
.mejs__button button {
  font-family: "Font Awesome 6 Free";
  font-weight: 900;
  font-size: 18px;
  color: #fff;
  background: none;
  border: none;
}

.mejs__play button::before { content: "\f04b"; }       /* play */
.mejs__pause button::before { content: "\f04c"; }      /* pause */
.mejs__mute button::before { content: "\f6a9"; }       /* mute */
.mejs__unmute button::before { content: "\f028"; }     /* volume on */
.mejs__fullscreen button::before { content: "\f065"; } /* fullscreen */
.mejs__unfullscreen button::before { content: "\f066"; } /* exit fullscreen */

.mejs__time, .mejs__time-current, .mejs__time-total { color: #fff; }
.mejs__time-current { color: #ff0000; }
.mejs__horizontal-volume-slider .mejs__horizontal-volume-current { background: #ff0000; }
.mejs__horizontal-volume-slider .mejs__horizontal-volume-total { background: #444; }
.mejs__time-rail .mejs__time-current { background: #ff0000; }
.mejs__time-rail .mejs__time-total { background: #444; }

.mejs__pause svg.mejs__icon-pause, .mejs__play svg.mejs__icon-play, .mejs__replay svg.mejs__icon-replay { display: none; }
.mejs__mute .mejs__icon-mute, .mejs__unmute .mejs__icon-unmute { display: none; }
.mejs__fullscreen svg.mejs__icon-fullscreen { display: none; }
</style>
</head>
<body>

<div class="player-container" id="player-container">
  <video id="stream-media" controls preload="auto">
    <source src="{{ mediaLink }}" type="video/mp4">
  </video>
  <img src="https://chadstreamz.sbs/assets/images/log2.png" class="watermark" alt="Watermark">
</div>

<div class="bottom-section">
  <a id="download-btn" class="download-btn">â¬‡ Download</a>
  <div class="suggestions">
    <h2>More Like This</h2>
    <div class="movies-grid">
      <div class="movie-card" onclick="window.location.href='https://chadstreamz.sbs'">
        <img src="https://image.tmdb.org/t/p/w500/weVXMD5QBGeQil4HEATZqAkXeEc.jpg" alt="Terminator">
        <div class="movie-title">Terminator</div>
      </div>
      <div class="movie-card" onclick="window.location.href='https://chadstreamz.sbs'">
        <img src="https://image.tmdb.org/t/p/w500/1g0dhYtq4irTY1GPXvft6k4YLjm.jpg" alt="Spiderman No Way Home">
        <div class="movie-title">Spiderman No Way Home</div>
      </div>
      <div class="movie-card" onclick="window.location.href='https://chadstreamz.sbs'">
        <img src="https://image.tmdb.org/t/p/w500/nAU74GmpUk7t5iklEp3bufwDq4n.jpg" alt="A Quiet Place">
        <div class="movie-title">A Quiet Place</div>
      </div>
    </div>
  </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/mediaelement@7.0.5/build/mediaelement-and-player.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>

<script>
const mediaLink = "{{ mediaLink }}" || "https://test-streams.mux.dev/x36xhzz/x36xhzz.m3u8";
const video = document.getElementById('stream-media');
const downloadBtn = document.getElementById('download-btn');
const container = document.getElementById('player-container');

downloadBtn.href = mediaLink;
downloadBtn.setAttribute("download", "");

// HLS support
if(mediaLink.endsWith('.m3u8') && Hls.isSupported()){
  const hls = new Hls();
  hls.loadSource(mediaLink);
  hls.attachMedia(video);
}else{
  video.src = mediaLink;
}

// Initialize MediaElement.js
const player = new MediaElementPlayer(video, {
  features: ['playpause','progress','current','duration','volume','fullscreen'],
  stretching: 'responsive',
  enableAutosize: true,
  alwaysShowControls: false,
  autoHide: true,
  autoHideTime: 2500
});

// Fix fullscreen container
video.addEventListener('fullscreenchange', () => {
  if(document.fullscreenElement){
    container.classList.add('fullscreen');
  } else {
    container.classList.remove('fullscreen');
  }
});
</script>
</body>
</html>
